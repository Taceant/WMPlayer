/*!
* WMPlayer v0.8
* Copyright 2016-2019 Marcin Walczak
*This file is part of WMPlayer which is released under MIT license.
*See LICENSE for full license details.
*/
function WMPlayer(t){var e,i=this;this.currentScript=document.currentScript||(e=document.getElementsByTagName("script"))[e.length-1],this.parentNode=(this.currentScript[this.currentScript.length-1]||this.currentScript).parentNode,this.container=document.createElement("div"),void 0!==this.container.classList?(this.container.classList.add("wmplayer"),this.container.classList.add("default")):this.container.className+=" wmplayer default";var a=document.createElement("div");void 0!==a.classList?a.classList.add("wmplayer-body"):a.className+=" wmplayer-body",this.container.appendChild(a);var s=document.createElement("div");if(s.className+="wmplayer-media",this.container.appendChild(s),(n=document.createElement("div")).className+="wmplayer-yt",s.appendChild(n),s.setAttribute("style","width: 0; height: 0; overflow: hidden; opacity: 0; visibility: hidden;"),0==document.querySelectorAll('script[src="https://www.youtube.com/iframe_api"]').length){var n;(n=document.createElement("script")).src="https://www.youtube.com/iframe_api";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r)}return this.started=!1,this.model=new this._Model,this.view=new this._View({playlist:"wmp-playlist",playButton:"wmp-play",stopButton:"wmp-stop",fastForwardButton:"wmp-fast-forward",rewindButton:"wmp-rewind",progressBar:"wmp-progress-bar",volumeBar:"wmp-volume-bar",muteButton:"wmp-mute",currentTrackTime:"wmp-current-track-time",currentTrackDuration:"wmp-current-track-duration",currentTrackTitle:"wmp-current-track-title",container:this.container}),this.view.setTemplate('<div class="wmp-panel"><div class="wmp-current-track"><span class="wmp-current-track-title"></span><span class="wmp-timer"><span class="wmp-current-track-time">0:00</span><span class="wmp-current-track-duration">N/A</span></span></div><div class="wmp-controls"><div class="wmp-play wmp-button"><svg class="wmp-button-play" width="18" height="18"><polygon class="wmp-symbol-play" points="2,2 16,9 2,16"/><g class="wmp-symbol-pause"><rect x="2" y="2" width="4" height="14" /><rect x="11" y="2" width="4" height="14" /><rect x="2" y="2" width="14" height="14" fill="transparent" stroke="transparent"/></g></svg></div><div class="wmp-stop wmp-button"><svg class="wmp-button-stop" width="18" height="18"><rect class="wmp-symbol-stop" x="2" y="2" width="14" height="14"/></svg></div><div class="wmp-rewind wmp-button"><svg class="wmp-button-rewind" width="18" height="18"><polygon class="wmp-symbol-rewind" points="2,9 9,2 9,9 16,2 16,16 9,9 9,16"/></svg></div><div class="wmp-fast-forward wmp-button"><svg class="wmp-button-fast-forward" width="18" height="18"><polygon class="wmp-symbol-fast-forward" points="2,2 9,9 9,2 16,9 9,16 9,8 2,16"/></svg></div></div><div class="wmp-volume-bar-container"><div class="wmp-button wmp-mute"><svg width="18" height="18"><g class="wmp-button-volume"><polygon points="2,6 5,6 10,2 10,16 5,12 2,12 " /><g class="wmp-symbol-muted"><path d="M12,4 Q18,9 12,14" fill="transparent" /><path d="M12,7 Q14,9 12,11" fill="transparent" /></g></g></svg></div><div class="wmp-volume-bar"></div></div><div class="wmp-progress-bar-container"><div class="wmp-progress-bar"></div></div></div><div class="wmp-playlist-container"><div class="wmp-playlist"></div><div class="wmp-footer">Powered by: <a href="https://github.com/wiserim/WMPlayer" target="_blank" rel="noopener noreferer">WMPlayer</a></div></div>'),this.view.setPlaylistPattern('<div class="$status"><span>$index.</span><span>$title</span><span>$duration</span></div>'),void 0!==t&&("string"==typeof t||t instanceof String||void 0!==t.nodeType&&1===t.nodeType||window.jQuery&&t instanceof jQuery?this.parent(t):(void 0!==t.parent&&this.parent(t.parent,t.parentAsTemplate),void 0!==t.template&&this.template(t.template),void 0!==t.theme&&this.theme(t.theme),void 0!==t.playlistPattern&&this.playlistPattern(t.playlistPattern),void 0!==t.controls&&this.controls(t.controls),void 0!==t.autoplay&&this.autoplay(t.autoplay),void 0!==t.loop&&this.loop(t.loop),void 0!==t.volume&&this.volume(t.volume),void 0!==t.mute&&this.mute(t.mute),void 0!==t.playlist&&t.playlist.forEach(function(t){i.addTrack(t.url,t.title)}),void 0!==t.showPlaylist&&this.showPlaylist(t.showPlaylist),!1!==t.start&&this.start())),this.model.audioTrackAdded.attach(function(){if(i.started){var t=i.model.getPlaylist(),e=i.model.getCurrentTrackIndex(),a=i.model.getCurrentTrackTitle(),s=i.model.getCurrentTrackDuration();i.view.renderPlaylist(t,e),i.view.setCurrentTrackData(a,s)}}),this.model.audioTrackRemoved.attach(function(){if(i.started){var t=i.model.getPlaylist(),e=i.model.getCurrentTrackIndex();i.view.renderPlaylist(t,e)}}),this.model.currentTrackChanged.attach(function(){if(i.started){var t=i.model.getPlaylist(),e=i.model.getCurrentTrackIndex(),a=i.model.getCurrentTrackTitle(),s=i.model.getCurrentTrackDuration();i.view.renderPlaylist(t,e),i.view.setCurrentTrackData(a,s)}}),this.model.volumeChanged.attach(function(){i.started&&(i.view.setVolumeBar(i.model.getVolume()),i.model.getMute()?i.view.addContainerClass("muted"):i.view.removeContainerClass("muted"))}),this.model.audioTrackPlaying.attach(function(){i.view.removeContainerClass("paused"),i.view.addContainerClass("playing")}),this.model.audioTrackPaused.attach(function(){i.view.removeContainerClass("playing"),i.view.addContainerClass("paused")}),this.model.audioTrackStopped.attach(function(){i.view.removeContainerClass("playing"),i.view.removeContainerClass("paused")}),this.model.audioTrackEnded.attach(function(){i.model.nextTrack()&&!i.playlistLoop?i.model.stop():i.model.play()}),this.model.durationChanged.attach(function(){var t=i.model.getCurrentTime(),e=i.model.getCurrentTrackDuration();i.view.setProgressBar(t,e),i.view.setCurrentTime(t)}),this.model.audioTrackError.attach(function(){i.model.setCurrentTrackError(),i.nextTrack()}),this.view.playButtonClicked.attach(function(){i.model.playing?i.model.pause():i.model.play()}),this.view.stopButtonClicked.attach(function(){i.model.stop()}),this.view.fastForwardButtonPressed.attach(function(){setTimeout(function(){i.view.mousedownFlag?i.mouseDown=setInterval(function(){i.view.mousedownFlag?i.model.fastForward():(clearInterval(i.mouseDown),i.mouseDown=-1)},500):i.nextTrack()},200)}),this.view.rewindButtonPressed.attach(function(){setTimeout(function(){i.view.mousedownFlag?i.mouseDown=setInterval(function(){i.view.mousedownFlag?i.model.rewind():(clearInterval(i.mouseDown),i.mouseDown=-1)},500):i.previousTrack()},200)}),this.view.progressBarClicked.attach(function(t,e){var a=i.model.getCurrentTrackDuration(),s=Math.floor(e.offsetX/e.width*a);i.model.setTime(s)}),this.view.volumeBarClicked.attach(function(t,e){var a=e.offsetX/e.width;i.model.setVolume(a)}),this.view.muteButtonClicked.attach(function(t,e){i.model.setMute()}),this.view.playlistElementDoubleClicked.attach(function(t,e){i.model.setAudioTrack(e.trackId),i.model.play()}),this.view.templateModified.attach(function(){if(i.started){var t=i.model.getCurrentTrackTitle(),e=i.model.getCurrentTrackDuration(),a=i.model.getPlaylist(),s=i.model.getCurrentTrackIndex();i.view.renderPlayer(),i.view.setCurrentTrackData(t,e),i.view.renderPlaylist(a,s)}}),this.view.playlistPatternModified.attach(function(){if(i.started){var t=i.model.getPlaylist(),e=i.model.getCurrentTrackIndex();i.view.renderPlaylist(t,e)}}),this}window.jQuery&&($.fn.WMPlayer=function(t){var e=$.makeArray(arguments).slice(1);return this.each(function(){var i=$.data(this,"wmplayer");if(i)if(i[t]){if(i[t].apply(i,e),"parent"==t&&t.length>0){var a=e[0];a.length>0&&(a=a[0]),$.removeData(this,"wmplayer"),void 0!==$.data(a,"wmplayer")&&$.data(a,"wmplayer").destroy(),$.data(a,"wmplayer",i)}}else $.error("Method "+t+" does not exist on WMPlayer");else if("string"!=typeof t){var s=t;void 0===s?s={parent:this}:void 0===s.parent&&(s.parent=this);var n=new WMPlayer(s);return $.data(this,"wmplayer",n),n}})}),WMPlayer.prototype={addTrack:function(t,e){return void 0===e&&(e="N/A"),this.model.addAudioTrack(t,e),this},removeTrack:function(t){return this.model.delAudioTrack(t),this},track:function(t){return void 0===t&&(t=0),this.model.setAudioTrack(t),this.started&&this.model.play(),this},nextTrack:function(){return this.model.nextTrack()&&!this.model.getLoop()?this.model.stop():this.model.playing&&this.model.play(),this},previousTrack:function(){return this.model.previousTrack(),this.model.playing&&this.model.play(),this},volume:function(t){return this.model.setVolume(t),this},mute:function(t){return this.model.setMute(t),this},template:function(t){return void 0===t&&(t=!1),t.length>0&&(t=t[0]),this.view.setTemplate(t),this},playlistPattern:function(t){return void 0!==t&&this.view.setPlaylistPattern(t),this},parent:function(t,e){var i;return void 0===t&&(t=(document.currentScript||(i=document.getElementsByTagName("script"),i[i.length-1])).parentNode),("string"==typeof t||t instanceof String)&&(t=document.querySelector(t)),null===t?(console.log("DOM element not found."),this):(t.length>0&&(t=t[0]),this.parentNode=t,1==e&&(this.view.setTemplate(t.innerHTML),t.innerHTML=""),this.started&&this.parentNode.appendChild(this.container),this)},loop:function(t){return this.model.setLoop(t),this},autoplay:function(t){return this.model.setAutoplay(t),this},controls:function(t){return this.view.setControls(t),this},showPlaylist:function(t){return this.view.setShowPlaylist(t),this},theme:function(t){return this.view.setPlayerClass(t),this},destroy:function(){return this.container.parentNode==this.parentNode&&this.parentNode.removeChild(this.container),this.started=!1,this},start:function(){if(!this.started){this.started=!0,this.parentNode.appendChild(this.container);var t=this.container.querySelector(".wmplayer-media");t.appendChild(this.model.audio);var e=t.querySelector(".wmplayer-yt");e.id="wmplayer-yt-"+document.querySelectorAll(".wmplayer .wmplayer-yt").length,this.model.YTIframeId=e.id;var i=this.model.getCurrentTrackTitle(),a=this.model.getCurrentTrackDuration(),s=this.model.getPlaylist(),n=this.model.getCurrentTrackIndex(),r=this.model.getVolume(),o=this.model.getMute(),l=this.model.getAutoplay();this.view.renderPlayer(),this.view.setProgressBar(),this.view.setVolumeBar(r),o&&this.view.addContainerClass("muted"),this.view.setCurrentTrackData(i,a),this.view.renderPlaylist(s,n),l?this.model.play():this.view.addContainerClass("paused")}return this}},WMPlayer.prototype._Event=function(t){this.sender=t,this.listeners=[]},WMPlayer.prototype._Event.prototype={attach:function(t){this.listeners.push(t)},notify:function(t){for(var e=0;e<this.listeners.length;e++)this.listeners[e](this.sender,t)}},WMPlayer.prototype._Model=function(){var t=this,e=WMPlayer.prototype._Event;this.audio=new Audio,this.YTIframeId="",this.YTIframe=!1,this.playlist=[],this.currentTrackIndex=null,this.currentTrackType="",this.loop=!1,this.autoplay=!1,this.timeChangeRate=5,this.volume=1,this.mute=!1,this.canPause=!0,this.playing=!1,this.YTReady=!1,this.YTState=-1,this.YTQuene=!1,this.YTCTInterval=-1,this.audioTrackAdded=new e(this),this.audioTrackRemoved=new e(this),this.currentTrackChanged=new e(this),this.audioTrackPlaying=new e(this),this.audioTrackPaused=new e(this),this.audioTrackStopped=new e(this),this.audioTrackEnded=new e(this),this.audioTrackError=new e(this),this.durationChanged=new e(this),this.volumeChanged=new e(this),this.volumeChanged=new e(this),this.audio.addEventListener("play",function(){t.audioTrackPlaying.notify()}),this.audio.addEventListener("playing",function(){t.audioTrackPlaying.notify()}),this.audio.addEventListener("ended",function(){t.audioTrackEnded.notify()}),this.audio.addEventListener("error",function(){t.canPause=!0,t.audioTrackError.notify()}),this.audio.addEventListener("durationchange",function(){t.durationChanged.notify()}),this.audio.addEventListener("timeupdate",function(){t.durationChanged.notify()}),this.audio.addEventListener("volumechange",function(){t.volumeChanged.notify()})},WMPlayer.prototype._Model.prototype={getPlaylist:function(){return this.playlist},getCurrentTrackIndex:function(){return this.currentTrackIndex},getCurrentTrackTitle:function(){return null===this.currentTrackIndex?"":this.playlist[this.currentTrackIndex].title},getCurrentTrackDuration:function(){if(null===this.currentTrackIndex)return 0;var t=this.playlist[this.currentTrackIndex].duration;return isNaN(t)?0:t},getCurrentTime:function(){return"audio"==this.playlist[this.currentTrackIndex].type?this.audio.currentTime:this.YTReady?this.YTIframe.getCurrentTime():0},getVolume:function(){return this.volume},getMute:function(){return this.mute},getAutoplay:function(){return this.autoplay},getLoop:function(){return this.loop},isPlaying:function(){return"audio"==this.playlist[this.currentTrackIndex].type?!this.audio.paused:!(!this.YTReady||1!=this.YTIframe.getPlayerState())},addAudioTrack:function(t,e){void 0===e&&(e="N/A");var a="ready",s="audio",n=this.parseYTURL(t);n&&(t=n,s="yt",a="ready"),this.playlist.push({title:e,url:t,duration:"N/A",type:s,status:a}),this.audioTrackAdded.notify();var r=this,o=this.playlist.length-1;if("audio"==s){var l=new Audio;l.onloadedmetadata=function(t){var e="";if(0!=r.playlist.length)for(i=0;i<r.playlist.length;i++)if(e=r.playlist[i].url.replace("../",""),(t.target.src.indexOf(e)>=0||t.target.src.indexOf(encodeURI(e))>=0)&&"N/A"==r.playlist[i].duration){r.playlist[i].duration=l.duration,r.audioTrackAdded.notify();break}},l.src=r.playlist[o].url,l.load()}else{var u="https://www.googleapis.com/youtube/v3/videos?key=AIzaSyDerqq5DmHBdfBWMHkaWwjvj4MbtYAD7-A&part=contentDetails&id="+r.playlist[o].url,d=new XMLHttpRequest;if("withCredentials"in d)d.open("GET",u,!0);else if(void 0!==typeof XDomainRequest)try{(d=new XDomainRequest).open("GET",u)}catch(t){d=!1,console.log("Error: "+t.message)}else d=!1,console.log("Error: CORS not supported");d&&(d.onload=function(){var t=JSON.parse(d.responseText);if("youtube#videoListResponse"==t.kind&&t.pageInfo.totalResults>0){var e=t.items[0],i=0;if(0==r.playlist.length)return;for(size=r.playlist.length;i<size;i++)e.id.indexOf(r.playlist[i].url)>=0&&"N/A"==r.playlist[i].duration&&(duration=r.convertYTDuration(e.contentDetails.duration),duration&&(r.playlist[i].duration=duration),r.audioTrackAdded.notify())}},d.onerror=function(){console.log("Error: Unable to retrieve data from You Tube")},d.send())}null===r.currentTrackIndex&&r.setAudioTrack()},delAudioTrack:function(t){if(0!=this.playlist.length){if(void 0===t&&(t=this.playlist.length-1),this.playlist.splice(t,1),t==this.currentTrackIndex){var e=this.isPlaying();this.stop(),0==this.playlist.length?this.setAudioTrack():this.currentTrackIndex>=this.playlist.length?this.setAudioTrack(t-1):this.setAudioTrack(t),e&&this.play()}else t<this.currentTrackIndex&&this.currentTrackIndex--;this.audioTrackRemoved.notify()}},setAudioTrack:function(t){var e=this;if(this.YTQuene=!1,clearInterval(this.YTCTInterval),void 0===t&&(t=0),null!==this.currentTrackIndex&&("audio"==this.playlist[this.currentTrackIndex].type?this.audio.pause():this.YTReady&&this.YTIframe.pauseVideo(),this.audioTrackPaused.notify()),this.playlist.length>t&&0<=t)if(this.canPause)"audio"==this.playlist[t].type?(this.audio.src=this.playlist[t].url,this.audio.load()):(this.YTIframe?this.YTIframe.loadVideoById({videoId:this.playlist[t].url,startSeconds:0,volume:this.volume,suggestedQuality:"small"}):this.initYTIframe(this.playlist[t].url),this.YTCTInterval=setInterval(function(){e.durationChanged.notify()},100)),this.currentTrackIndex=t,this.currentTrackChanged.notify();else var i=setInterval(function(){(e.canPause||"error"==e.playlist[e.currentTrackIndex].status)&&(e.canPause=!0,"audio"==e.playlist[t].type?(e.audio.src=e.playlist[t].url,e.audio.load()):(e.YTIframe?e.YTIframe.loadVideoById({videoId:e.playlist[t].url,startSeconds:0,suggestedQuality:"small"}):e.initYTIframe(e.playlist[t].url),e.YTCTInterval=setInterval(function(){e.durationChanged.notify()},100)),e.currentTrackIndex=t,e.currentTrackChanged.notify(),clearInterval(i))},10);else this.currentTrackIndex=null},setVolume:function(t){void 0===t&&(t=1),t<0?t=0:t>1&&(t=1),this.volume=t,this.mute=!1,this.audio.volume=this.volume,this.YTIframe&&(this.YTIframe.setVolume(100*t),this.YTIframe.unMute())},setMute:function(t){this.mute=void 0===t?!this.mute:!!t,this.mute?(this.audio.volume=0,this.YTIframe&&this.YTIframe.mute()):(this.audio.volume=this.volume,this.YTIframe&&this.YTIframe.unMute())},setAutoplay:function(t){this.autoplay=void 0===t?!this.autoplay:!!t},setLoop:function(t){this.loop=void 0===t?!this.loop:!!t},setCurrentTrackError:function(){this.playlist[this.currentTrackIndex].status="error"},play:function(){if(self=this,this.canPause=!1,0!=this.playlist.length&&(null===this.currentTrackIndex&&this.setAudioTrack(),null!==this.currentTrackIndex)){if("audio"==this.playlist[this.currentTrackIndex].type){var t=this.audio.play();if(void 0!==t&&"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]"))try{t.then(function(){self.canPause=!0}).catch(function(){self.canPause=!0})}catch(t){self.canPause=!0}else this.canPause=!0}else this.YTReady?(this.YTIframe.playVideo(),this.canPause=!0,this.audioTrackPlaying.notify()):this.YTQuene="play";this.playing=!0}},pause:function(){"audio"==this.playlist[this.currentTrackIndex].type?this.audio.pause():this.YTReady?this.YTIframe.pauseVideo():this.YTQuene="pause",this.audioTrackPaused.notify(),this.playing=!1},stop:function(){if("audio"==this.playlist[this.currentTrackIndex].type){if(this.audio.src){this.audio.pause();try{this.audio.currentTime=0}catch(t){}this.audioTrackStopped.notify()}}else this.YTReady?(this.YTIframe.pauseVideo(),this.YTIframe.seekTo(0),this.audioTrackStopped.notify()):this.YTQuene="stop";this.playing=!1},nextTrack:function(){var t=!1;return this.currentTrackIndex<this.playlist.length-1?this.setAudioTrack(this.currentTrackIndex+1):(this.setAudioTrack(),t=!0),this.currentTrackChanged.notify(),t},previousTrack:function(){this.currentTrackIndex>0?this.setAudioTrack(this.currentTrackIndex-1):this.setAudioTrack(),this.currentTrackChanged.notify()},setTime:function(t){"audio"==this.playlist[this.currentTrackIndex].type?this.audio.src&&(this.audio.currentTime=t):this.YTReady&&this.YTIframe.seekTo(t)},fastForward:function(){var t=this.getCurrentTime()+this.timeChangeRate;"audio"==this.playlist[this.currentTrackIndex].type?t<this.audio.duration&&t>=0&&this.audio.buffered.start(0)<=t&&this.audio.buffered.end(0)>=t&&(this.audio.currentTime=t):this.YTReady&&t<this.YTIframe.getDuration()&&t>=0&&this.YTIframe.seekTo(t)},rewind:function(){var t=this.getCurrentTime()-this.timeChangeRate;"audio"==this.playlist[this.currentTrackIndex].type?t<this.audio.duration&&t>=0&&this.audio.buffered.start(0)<=t&&this.audio.buffered.end(0)>=t&&(this.audio.currentTime=t):this.YTReady&&this.YTIframe.seekTo(t)},parseYTURL:function(t){var e=t.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);return!(!e||11!=e[7].length)&&e[7]},convertYTDuration:function(t){var e=/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?$/,i=0,a=0,s=0,n=!1;if(e.test(t)){var r=e.exec(t);r[1]&&(i=Number(r[1])),r[2]&&(a=Number(r[2])),r[3]&&(s=Number(r[3])),n=3600*i+60*a+s}return n},initYTIframe:function(t){if(!this.YTIframe)var e=this,i=setInterval(function(){e.YTIframe?clearInterval(i):"undefined"!=typeof YT&&YT.loaded&&(e.YTIframe=new YT.Player(e.YTIframeId,{videoId:t,playerVars:{autoplay:0,controls:0},events:{onReady:function(t){if(e.YTReady=!0,t.target.setVolume(100*e.volume),e.mute&&t.target.mute(),e.YTQuene){switch(e.YTQuene){case"play":e.play();break;case"pause":e.pause();break;case"stop":e.stop()}e.YTquene=!1}},onStateChange:function(t){e.YTState=e.YTIframe.getPlayerState(),0===e.YTState&&e.audioTrackEnded.notify()},onError:function(){e.audioTrackError.notify()}}}),clearInterval(i))},10)}},WMPlayer.prototype._View=function(t){var e=this,i=WMPlayer.prototype._Event;this.elements=t,this.template=null,this.playlistPattern="",this.playerClass="default",this.container=this.elements.container,this.mousedownFlag=!1,this.showPlaylist=!0,this.dragged=!1,this.mouseOnVolumeBar=!1,this.mouseOnProgressBar=!1,this.playButtonClicked=new i(this),this.stopButtonClicked=new i(this),this.fastForwardButtonPressed=new i(this),this.rewindButtonPressed=new i(this),this.progressBarClicked=new i(this),this.volumeBarClicked=new i(this),this.muteButtonClicked=new i(this),this.playlistElementDoubleClicked=new i(this),this.templateModified=new i(this),this.playlistPatternModified=new i(this),this.container.addEventListener("click",function(t){var i=e.getParentsNodes(t.target,e.elements.container);e.isParent(i,e.elements.playButton)&&e.playButtonClicked.notify(),e.isParent(i,e.elements.stopButton)&&e.stopButtonClicked.notify();var a=e.isParent(i,e.elements.progressBar,!0);if(a){var s=a.parentNode,n=0,r=a.getBoundingClientRect(),o=t.clientX-r.left;n=s.hasAttribute("width")?s.getAttribute("width"):s.offsetWidth,e.progressBarClicked.notify({offsetX:o,width:n})}var l=e.isParent(i,e.elements.volumeBar,!0);if(l){var u=l.parentNode;n=0,r=l.getBoundingClientRect(),o=t.clientX-r.left;n=u.hasAttribute("width")?u.getAttribute("width"):u.offsetWidth,e.volumeBarClicked.notify({offsetX:o,width:n})}e.isParent(i,e.elements.muteButton)&&e.muteButtonClicked.notify()});var a=function(t){var i=e.getParentsNodes(t.target,e.elements.container),a=e.isParent(i,"wmp-playlist-item");if(a){for(var s=0;null!==(a=a.previousSibling);)++s;e.playlistElementDoubleClicked.notify({trackId:s})}},s=function(t){if(1==t.which||void 0!==t.touches){var i=e.getParentsNodes(t.target,e.elements.container),a=e.isParent(i,e.elements.volumeBar,!0);if(a&&e.mouseOnVolumeBar){var s=a.parentNode,n=0,r=a.getBoundingClientRect(),o=(t.clientX||t.touches[0].clientX)-r.left;n=s.hasAttribute("width")?s.getAttribute("width"):s.offsetWidth,e.volumeBarClicked.notify({offsetX:o,width:n})}var l=e.isParent(i,e.elements.progressBar,!0);if(l&&e.mouseOnProgressBar){var u=l.parentNode;n=0,r=l.getBoundingClientRect(),o=(t.clientX||t.touches[0].clientX)-r.left;n=u.hasAttribute("width")?u.getAttribute("width"):u.offsetWidth,e.progressBarClicked.notify({offsetX:o,width:n})}}};this.container.addEventListener("dblclick",function(t){a(t)}),this.container.addEventListener("touchstart",function(t){!function(t){e.mouseOnVolumeBar=!1,e.mouseOnProgressBar=!1,e.dragged=!1;var i=e.getParentsNodes(t.target,e.elements.container);e.isParent(i,e.elements.volumeBar,!0)&&(e.mouseOnVolumeBar=!0),e.isParent(i,e.elements.progressBar,!0)&&(e.mouseOnProgressBar=!0)}(t)}),this.container.addEventListener("touchmove",function(t){this.dragged=!0,s(t)}),this.container.addEventListener("touchend",function(t){this.dragged||a(t),this.dragged=!1}),this.container.addEventListener("mousedown",function(t){!function(t){e.mouseOnVolumeBar=!1,e.mouseOnProgressBar=!1;var i=e.getParentsNodes(t.target,e.elements.container);e.isParent(i,e.elements.fastForwardButton)&&(e.mousedownFlag=!0,e.fastForwardButtonPressed.notify()),e.isParent(i,e.elements.rewindButton)&&(e.mousedownFlag=!0,e.rewindButtonPressed.notify()),e.isParent(i,e.elements.volumeBar,!0)&&(e.mouseOnVolumeBar=!0),e.isParent(i,e.elements.progressBar,!0)&&(e.mouseOnProgressBar=!0)}(t)}),this.container.addEventListener("mouseup",function(t){e.mousedownFlag=!1,e.mouseOnVolumeBar=!1,e.mouseOnProgressBar=!1}),this.container.addEventListener("mousemove",function(t){s(t)})},WMPlayer.prototype._View.prototype={renderPlayer:function(){null!==this.template&&(this.elements.container.getElementsByClassName("wmplayer-body")[0].innerHTML=this.template)},renderPlaylist:function(t,e){var i="",a="",s=this.elements.container.getElementsByClassName(this.elements.playlist);if(this.showPlaylist&&s.length>0)for(var n=0;n<t.length;n++)a="wmp-playlist-item",n==e&&(a+=" wmp-current"),"error"==t[n].status&&(a+=" wmp-error"),i+=this.playlistPattern.replace("$index",n+1).replace("$title",t[n].title).replace("$duration",this.formatTime(t[n].duration)).replace("$status",a);for(n=0;s.length>n;n++)s[n].innerHTML=i},setTemplate:function(t){1===t.nodeType?this.template=t.innerHTML:this.template=t,this.templateModified.notify()},setPlaylistPattern:function(t){this.playlistPattern=t,this.playlistPatternModified.notify()},setShowPlaylist:function(t){this.showPlaylist=void 0===t?!this.showPlaylist:1==t,this.playlistPatternModified.notify()},setVolumeBar:function(t){void 0===t&&(t=0);for(var e=this.elements.container.getElementsByClassName(this.elements.volumeBar),i=0;i<e.length;i++)e[i].style.width=100*t+"%"},setProgressBar:function(t,e){var i=0,a=this.elements.container.getElementsByClassName(this.elements.progressBar);void 0!==t&&void 0!==e&&(i=t/e*100);for(var s=0;s<a.length;s++)a[s].style.width=i+"%"},formatTime:function(t){var e="N/A";if(!isNaN(t)){var i=Math.floor(t/60),a=Math.floor(t-60*i);e=i+":"+(a<10?"0":"")+a}return e},setCurrentTime:function(t){for(var e=this.elements.container.getElementsByClassName(this.elements.currentTrackTime),i=this.formatTime(t),a=0;a<e.length;a++)e[a].innerHTML=i},getParentsNodes:function(t,e){var i=[],a=t;for(i.push(a);a.parentNode&&a!=e;)i.unshift(a.parentNode),a=a.parentNode;return i},isParent:function(t,e,i){if(t.length>1){for(var a=0;a<t.length;a++)if(void 0!==t[a].classList){if(t[a].classList.contains(e)||(" "+t[a].getAttribute("class")+" ").indexOf(" "+e+" ")>-1)return t[a]}else if((" "+t[a].getAttribute("class")+" ").indexOf(" "+e+" ")>-1)return t[a]}else if(t.classList.contains(e)||(" "+t.className+" ").indexOf(" "+e+" ")>-1)return t;if(i){var s=this.container.getElementsByClassName(e);for(a=0;a<s.length;a++)if(s[a].parentNode===t[t.length-1])return s[a]}return!1},setCurrentTrackData:function(t,e){for(var i=this.elements.container.getElementsByClassName(this.elements.currentTrackTitle),a=this.elements.container.getElementsByClassName(this.elements.currentTrackDuration),s=0;s<i.length;s++)null!==i[s]&&(i[s].innerHTML=t);var n=this.formatTime(e);for(s=0;s<a.length;s++)null!==a[s]&&(a[s].innerHTML=n)},addContainerClass:function(t){var e=this,i=t.split(" ");if(void 0!==this.elements.container.classList)i.forEach(function(t){e.elements.container.classList.add(t)});else{var a=" "+this.elements.container.className+" ";i.forEach(function(t){-1==a.indexOf(" "+t+" ")&&(e.elements.container.className+=" "+t)})}},removeContainerClass:function(t){var e=this,i=t.split(" ");if(void 0!==this.elements.container.classList)i.forEach(function(t){e.elements.container.classList.remove(t)});else{var a=" "+this.elements.container.className+" ";i.forEach(function(t){var i=new RegExp(" "+t+" ","g");a=a.replace(i," "),e.elements.container.className=a.trim()})}},setPlayerClass:function(t){this.removeContainerClass(this.playerClass),this.addContainerClass(t),this.playerClass=t},setControls:function(t){void 0!==t.playlist&&(this.elements.playlist=t.playlist),void 0!==t.playButton&&(this.elements.playButton=t.playButton),void 0!==t.stopButton&&(this.elements.stopButton=t.stopButton),void 0!==t.fastForwardButton&&(this.elements.fastForwardButton=t.fastForwardButton),void 0!==t.rewindButton&&(this.elements.rewindButton=t.rewindButton),void 0!==t.progressBar&&(this.elements.progressBar=t.progressBar),void 0!==t.volumeBar&&(this.elements.volumeBar=t.volumeBar),void 0!==t.muteButton&&(this.elements.muteButton=t.muteButton),void 0!==t.currentTrackTime&&(this.elements.currentTrackTime=t.currentTrackTime),void 0!==t.currentTrackDuration&&(this.elements.currentTrackDuration=t.currentTrackDuration),void 0!==t.currentTrackTitle&&(this.elements.currentTrackTitle=t.currentTrackTitle)}};
